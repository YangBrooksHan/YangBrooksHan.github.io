<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button type="button" aria-label="Toggle menu">
          <div class="navicon"></div>
        </button>

        <!-- Language switch (do NOT put this inside visible-links; keep it always visible) -->
        <ul class="lang-links">
          <li class="masthead__menu-item masthead__menu-item--lg masthead__menu-home-item">
            {% if page.url contains '/en/' %}
              <a href="{{ '/' | relative_url }}" target="_self" class="lang-link">
                <img class="svg" src="{{ '/images/cn.svg' | relative_url }}" width="20pt" alt="中文">
                中文
              </a>
            {% else %}
              <a href="{{ '/en/' | relative_url }}" target="_self" class="lang-link">
                <img class="svg" src="{{ '/images/en.svg' | relative_url }}" width="20pt" alt="English">
                English
              </a>
            {% endif %}
          </li>
        </ul>

        <!-- Nav links (greedy-nav manages these) -->
        <ul class="visible-links">
          {% assign nav = site.data.navigation.main %}
          {% if page.url contains '/en/' %}
            {% assign nav = site.data.navigation_en.main %}
          {% endif %}

          {% for link in nav %}
            {% assign href = link.url %}
            {% assign first_char = href | slice: 0, 1 %}
            {% if first_char != '#' %}
              {% assign href = href | relative_url %}
            {% endif %}

            <li class="masthead__menu-item">
              <a href="{{ href }}">{{ link.title }}</a>
            </li>
          {% endfor %}
        </ul>

        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
